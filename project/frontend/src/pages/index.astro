---
import Layout from "@layouts/global.astro";
import Button from "@components/base/Button.svelte";
import Card from "@components/base/Card.svelte";
import { Authentication } from "shared/models";

const token = Authentication.validateToken(Astro.request);
if (token) return Astro.redirect("/dashboard");
---

<Layout title="Home" desc="SkillSwap - Learn. Teach. Connect.">
    <section class="hero">
        <div class="hero-content">
            <h1 class="gradient-text">Learn. Teach. Connect.</h1>
            <p class="tagline">Join the community where students exchange skills and grow together.</p>
            <div class="cta-buttons">
                <Button href="/auth/register" variant="primary" class="hero-btn">Sign Up</Button>
                <Button href="#skills" variant="outline" class="hero-btn">Explore Skills</Button>
            </div>
        </div>
        <div class="hero-visual">
            <img src="/images/logos/logo-lg-transparent.png" alt="SkillSwap" class="preview-image" />
        </div>
    </section>

    <section id="features" class="section-container">
        <h2 class="section-title">Why Join SkillSwap?</h2>
        <div class="features-list">
            <div class="feature-item">
                <span class="feature-icon">üèÜ</span>
                <div class="feature-text">
                    <h3>Gamification</h3>
                    <p>Earn badges and climb the leaderboard.</p>
                </div>
            </div>
            <div class="feature-item">
                <span class="feature-icon">üí¨</span>
                <div class="feature-text">
                    <h3>Instant Messaging</h3>
                    <p>Chat directly with your mentors and students.</p>
                </div>
            </div>
            <div class="feature-item">
                <span class="feature-icon">üë•</span>
                <div class="feature-text">
                    <h3>Clubs & Groups</h3>
                    <p>Join interest-based groups for group learning.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="how-it-works" class="section-container bg-alt">
        <h2 class="section-title">How It Works</h2>
        <div class="steps-container">
            <div class="step-line"></div>
            <div class="step-item">
                <div class="step-marker">1</div>
                <div class="step-content">
                    <h3>Create Profile</h3>
                    <p>Sign up and list your skills to learn and teach.</p>
                </div>
            </div>
            <div class="step-item">
                <div class="step-marker">2</div>
                <div class="step-content">
                    <h3>Browse Skills</h3>
                    <p>Find students offering the skills you need.</p>
                </div>
            </div>
            <div class="step-item">
                <div class="step-marker">3</div>
                <div class="step-content">
                    <h3>Connect</h3>
                    <p>Message mentors and schedule a session.</p>
                </div>
            </div>
            <div class="step-item">
                <div class="step-marker">4</div>
                <div class="step-content">
                    <h3>Learn & Grow</h3>
                    <p>Master new skills and rate your experience.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="skills" class="section-container">
        <h2 class="section-title">Featured Skills</h2>
        <div class="skills-grid">
            <Card class="skill-card" href="/search?q=Math">
                <div class="skill-icon">üìê</div>
                <h3>Math</h3>
                <p>Calculus, Algebra, Statistics</p>
            </Card>
            <Card class="skill-card" href="/search?q=Guitar">
                <div class="skill-icon">üé∏</div>
                <h3>Guitar</h3>
                <p>Acoustic, Electric, Theory</p>
            </Card>
            <Card class="skill-card" href="/search?q=Coding">
                <div class="skill-icon">üíª</div>
                <h3>Coding</h3>
                <p>Python, JavaScript, React</p>
            </Card>
            <Card class="skill-card" href="/search?q=Photography">
                <div class="skill-icon">üì∑</div>
                <h3>Photography</h3>
                <p>Portrait, Landscape, Editing</p>
            </Card>
        </div>
    </section>

    <section class="final-cta">
        <div class="cta-content">
            <h2>Ready to Start Learning?</h2>
            <p>Join thousands of students sharing skills today.</p>
            <Button href="/auth/register" variant="primary" size="lg">Join SkillSwap Now</Button>
        </div>
    </section>
</Layout>

<style lang="scss">
    .final-cta {
        text-align: center;
        padding: 6rem 2rem;
        background-color: color-mix(in srgb, var(--background), var(--accent-1) 5%);
        color: var(--foreground);
        margin-top: 0;
    }

    .final-cta h2 {
        color: var(--accent-1);
        font-size: 2.5rem;
        margin-bottom: 1rem;
    }

    .final-cta p {
        font-size: 1.2rem;
        margin-bottom: 2rem;
        opacity: 0.8;
    }

    .section-container {
        width: 100%;
        padding: 4rem 2rem;
        box-sizing: border-box;
        border-bottom: 1px solid var(--accent-3);
    }

    .section-title {
        text-align: center;
        font-size: 2.5rem;
        color: var(--accent-1);
        margin-bottom: 3rem;
    }

    .bg-alt {
        background-color: color-mix(in srgb, var(--background), var(--accent-3) 10%);
    }

    .hero {
        flex-direction: row;
        align-items: center;
        min-height: 50vh;
        padding: 2rem 5%;
        gap: 2rem;
        background: linear-gradient(
            135deg,
            var(--background) 0%,
            color-mix(in srgb, var(--background), var(--accent-3) 20%) 100%
        );
        border-bottom: 1px solid var(--accent-3);
    }

    .hero-content {
        flex: 1;
        max-width: 600px;
    }

    .hero-visual {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 2rem;
    }

    .preview-image {
        width: 100%;
        max-width: 500px;
        height: auto;
        filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.1));
    }

    .gradient-text {
        font-size: 4rem;
        font-weight: 800;
        margin: 0;
        line-height: 1.1;
        background-image: linear-gradient(45deg, var(--accent-1), var(--accent-2));
        background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .tagline {
        font-size: 1.5rem;
        color: var(--foreground);
        opacity: 0.8;
        margin-top: 1.5rem;
        margin-bottom: 2.5rem;
    }

    .cta-buttons {
        display: flex;
        gap: 1rem;
    }

    .steps-container {
        display: flex;
        justify-content: space-between;
        position: relative;
        gap: 2rem;
        padding: 2rem 0;
        max-width: 1000px;
        margin: 0 auto;
    }

    .step-line {
        position: absolute;
        top: 50px;
        left: 12.5%;
        right: 12.5%;
        height: 3px;
        background: var(--accent-3);
        z-index: 0;
        opacity: 0.5;
    }

    .step-item {
        flex: 1;
        text-align: center;
        position: relative;
        z-index: 1;
    }

    .step-marker {
        width: 60px;
        height: 60px;
        background: var(--background);
        border: 3px solid var(--accent-2);
        color: var(--foreground); /* Improved contrast */
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: 800;
        margin: 0 auto 1.5rem;
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        box-shadow: 0 0 0 10px var(--background); /* Creates gap around line */
    }

    .step-item:hover .step-marker {
        background: var(--accent-2);
        border-color: var(--accent-2);
        color: var(--foreground);
        transform: scale(1.2);
        box-shadow:
            0 10px 25px rgba(80, 227, 194, 0.4),
            0 0 0 10px var(--background);
    }

    .step-content h3 {
        margin-bottom: 0.5rem;
        color: var(--foreground);
        font-size: 1.2rem;
    }

    .step-content p {
        font-size: 0.95rem;
        opacity: 0.8;
        line-height: 1.5;
        padding: 0 0.5rem;
    }

    @media (max-width: 768px) {
        .steps-container {
            flex-direction: column;
            gap: 0;
            padding-left: 1rem;
        }

        .step-line {
            top: 2rem;
            left: calc(1rem + 30px - 1.5px); /* Center of 60px marker (30px) + padding (1rem) - half line width */
            width: 3px;
            height: calc(100% - 4rem);
            right: auto;
        }

        .step-item {
            display: flex;
            text-align: left;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
            align-items: flex-start;
        }

        .step-marker {
            margin: 0;
            flex-shrink: 0;
        }

        .step-content {
            padding-top: 0.5rem;
        }
    }

    /* Featured Skills */
    .skills-grid {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 2rem;
        max-width: 1400px;
        margin: 0 auto;
    }

    :global(.skill-card) {
        flex: 1 1 240px;
        max-width: 280px;
        text-align: center;
        transition: all 0.3s ease;
        cursor: pointer;

        &:hover {
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
            transform: translateY(-10px);
            border-color: var(--accent-1);
        }
    }

    .skill-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
    }

    /* Features List */
    .features-list {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 3rem;
        max-width: 1200px;
        margin: 0 auto;
    }

    .feature-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        background: var(--background);
        padding: 1.5rem;
        border-radius: 1rem;
        border: 1px solid var(--accent-3);
        flex: 1 1 300px;
        max-width: 400px;
        transition: all 0.3s ease;
        cursor: pointer;
    }

    .feature-item:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        border-color: var(--accent-1);
    }

    .feature-icon {
        font-size: 2.5rem;
    }

    .feature-text h3 {
        margin: 0 0 0.5rem;
        color: var(--accent-1);
    }

    .feature-text p {
        margin: 0;
        font-size: 0.9rem;
        opacity: 0.8;
    }

    @media (max-width: 768px) {
        .hero {
            flex-direction: column;
            text-align: center;
            padding: 3rem 1.5rem;
            min-height: auto;
        }

        .hero-content {
            margin-bottom: 2rem;
        }

        .hero-visual {
            display: none;
        }

        .cta-buttons {
            justify-content: center;
            flex-direction: column;
            gap: 1rem;
            padding: 0 2rem;
        }

        .hero-btn {
            width: 100%;
        }

        .gradient-text {
            font-size: 2.5rem;
        }
    }
</style>
